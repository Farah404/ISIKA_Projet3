<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:svg="http://www.w3.org/2000/svg" lang="en"
	xmlns:f="http://java.sun.com/jsf/core">

<f:metadata>
	<f:event listener="#{userProfileBean.init()}" type="preRenderView">
	</f:event>
</f:metadata>

<h:head>
	<script src="subResources/scripts/jquery-3.3.1.js"></script>
	<script src="subResources/scripts/jquery.validate-vsdoc.js"></script>
	<script src="subResources/scripts/jquery.validate.unobtrusive.js"></script>
</h:head>

<h:body>
	<ui:composition template="#{templateBean.subtemplatePath()}">
		<ui:define name="subcontent">
			<h:form>
				<div class="container bootstrap snippets bootdey">
					<div class="panel-body inf-content">
						<div class="row">
							<div class="col-md-4">
<h:graphicImage style="width:600px" class="img-circle img-thumbnail isTooltip" url="/subWebsite/subMedia/ProfilePictures/#{userProfileBean.user.userAccount.profilePicturePath}"/>
								<ul title="Username" class="list-inline ratings text-center">

									<h3>#{userProfileBean.user.userAccount.username}</h3>

								</ul>
								<h:commandButton class="btn btn-success center-block"
									action="#{userProfileBean.updateStepOne()}"
									value="Modifier mon profil" />
								<br />
							</div>


							<div class="container">
								<div class="row my-2">
									<div class="col-md-8">


										<div class="portlet-body">
											<div>

												<!-- Nav tabs -->
												<ul class="nav nav-tabs">
													<li class="nav-item"><a href="" data-target="#general"
														data-toggle="tab" class="nav-link active text-success">Général</a>
													</li>
													<li class="nav-item"><a href="" data-target="#wallet"
														data-toggle="tab" class="nav-link text-success">EcoWallet</a>
													</li>
													<li class="nav-item"><a href="" data-target="#rib"
														data-toggle="tab" class="nav-link text-success">RIB
															&amp; Adresse de facturation</a></li>
													<li class="nav-item"><a href=""
														data-target="#vehicule" data-toggle="tab"
														class="nav-link text-success">Véhicule &amp; Assurance</a>
													</li>
													<li class="nav-item"><a href="" data-target="#sms"
														data-toggle="tab" class="nav-link text-success">Messagerie</a>
													</li>
												</ul>

												<!-- Tab panes -->
												<div class="tab-content">
													<div class="tab-pane active" id="general">
														<table class="table table-user-information">
															<tbody>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-user  text-success"></span>
																		Nom et prénom</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.lastName}
																			#{userProfileBean.user.firstName}</p>
																	</td>
																</tr>


																<tr>
																	<td><span
																		class="glyphicon glyphicon-gift text-success"></span>
																		Date de naissance</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.birthDate}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-inbox text-success"></span>
																		Email</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.email}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-phone text-success"></span>
																		Numéro de téléphone</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.phoneNumber}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-credit-card text-success"></span>
																		Numéro de carte d'identité ou passeport</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.identityCardnumber}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-dashboard text-success"></span>
																		Numéro de permis de conduire</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.drivingPermitNumber}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-calendar text-success"></span>
																		Date de création du compte</td>
																	<td class="text-success">
																		<p>#{userProfileBean.formatDateCreation}</p>
																	</td>
																</tr>
															</tbody>
														</table>
													</div>



													<div class="tab-pane" id="wallet">
														<table class="table table-user-information">
															<tbody>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-piggy-bank  text-success"></span>
																		Montant EcoCoins</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.wallet.internalCurrencyAmount}</p>
																	</td>
																</tr>
															</tbody>
														</table>
													</div>



													<div class="tab-pane" id="rib">
														<table class="table table-user-information">
															<tbody>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-font  text-success"></span>
																		Nom de l'agence bancaire</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.bankDetails.bankName}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-sort-by-order-alt text-success"></span>
																		Numéro SWIFT</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.bankDetails.swift}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-sort-by-order text-success"></span>
																		Numéro IBAN</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.bankDetails.iban}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-map-marker  text-success"></span>
																		Adresse</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.billingAddress.addressLine}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-tree-conifer text-success"></span>
																		Ville</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.billingAddress.city}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-globe text-success"></span>
																		Pays</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.billingAddress.country}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-send text-success"></span>
																		Code Postal</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.billingAddress.postalCode}</p>
																	</td>
																</tr>
															</tbody>
														</table>
													</div>

													<div class="tab-pane" id="vehicule">
														<table class="table table-user-information">
															<tbody>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-sort-by-alphabet  text-success"></span>
																		Nom de l'assureur</td>
																	<td class="text-success">
																		<p>#{userProfileBean.user.userAccount.vehicule.insurance.insuranceAgencyName}</p>
																	</td>
																</tr>
																<tr>
																	<td><span
																		class="glyphicon glyphicon-hourglass text-success"></span>
																		Date de fin de validité de l'assurance</td>
																	<td class="text-success">

																		<p>#{userProfileBean.user.userAccount.vehicule.insurance.insuranceContractExpiration}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-dashboard text-success"></span>
																		Numéro du contrat d'assurance</td>
																	<td class="text-success">

																		<p>#{userProfileBean.user.userAccount.vehicule.insurance.insuranceContractNumber}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-wrench text-success"></span>
																		Marque du véhicule</td>
																	<td class="text-success">

																		<p>#{userProfileBean.user.userAccount.vehicule.brand}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-sort-by-order text-success"></span>
																		Plaque d'immatriculation</td>
																	<td class="text-success">

																		<p>#{userProfileBean.user.userAccount.vehicule.registrationNumber}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-briefcase text-success"></span>
																		Date de fin de validité du contrôle technique</td>
																	<td class="text-success">

																		<p>#{userProfileBean.user.userAccount.vehicule.technicalTestExpiration}</p>
																	</td>
																</tr>

																<tr>
																	<td><span
																		class="glyphicon glyphicon-user text-success"></span>
																		Nombre de sièges disponibles</td>
																	<td class="text-success">

																		<p>#{userProfileBean.user.userAccount.vehicule.availableSeats}</p>
																	</td>
																</tr>

															</tbody>
														</table>
													</div>


													<div class="tab-pane" id="sms">
														<div class="table-responsive">					
							<h:dataTable class="table"
							value="#{userProfileBean.messageBetweenUsers}"
							var="message">
							<h:column>
								<f:facet name="header">Expéditeur</f:facet>
								<h:outputText value="#{message.userAccountSender.username}" />
							</h:column>
							<h:column>
								<f:facet name="header">Prestation</f:facet>
								<h:outputText
									value="#{message.referenceNumberConcerned}" />
							</h:column>
							<h:column>
								<f:facet name="header">Contenu du message</f:facet>
								<h:outputText
									value="#{message.messageContent}" />
							</h:column>
							<h:column>
								<f:facet name="header">Réponse</f:facet>
								<h:inputText
									value="#{userProfileBean.messageContentSending}" />
							</h:column>
							<h:column>
								<f:facet name="header">Répondre</f:facet>
								<h:panelGrid>
									<h:commandButton value="Répondre"
										action="#{userProfileBean.sendMessage(message.userAccountSender, message.serviceId, message.referenceNumberConcerned)}">
										<f:param name="userAccountSender"
											value="#{message.userAccountSender}"></f:param>
										<f:param name="serviceId"
											value="#{message.serviceId}"></f:param>
										<f:param name="referenceNumberConcerned"
											value="#{message.referenceNumberConcerned}"></f:param>

									</h:commandButton>
								</h:panelGrid>
							</h:column>
						</h:dataTable>				
														</div>
													</div>
												</div>
											</div>
										</div>

									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<br />
				<br />
				<br />


				<div id="services" class="container-fluid">
					<div class="table-responsive">
						<p
							style="float: left; font-variant: small-caps; font-weight: bold; font-size: larger">Mon
							historique de prestations de covoiturage</p>

						<h:dataTable class="table container-fluid bg-grey"
							value="#{userProfileBean.cpsListUserRelated}"
							var="cpsUserRelated">

							<h:column>
								<f:facet name="header"> Numéro de référence </f:facet>
								<h:outputText value="#{cpsUserRelated.referenceNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header"> Adresse de départ </f:facet>
								<h:outputText value="#{cpsUserRelated.trajectory.pickUpAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header"> Date et heure de départ</f:facet>
								<h:outputText value="#{cpsUserRelated.startDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header"> Adresse d'arrivée </f:facet>
								<h:outputText
									value="#{cpsUserRelated.trajectory.deliveryAddress}" />
							</h:column>

							<h:column>
								<f:facet name="header"> Date et heure d'arrivée</f:facet>
								<h:outputText value="#{cpsUserRelated.endDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header">Durée (heures)</f:facet>
								<h:outputText value="#{cpsUserRelated.trajectory.durationHours}" />

							</h:column>
							<h:column>
								<f:facet name="header">Nombre d'arrets</f:facet>
								<h:outputText value="#{cpsUserRelated.trajectory.stopNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header">Sièges disponibles</f:facet>
								<h:outputText value="#{cpsUserRelated.availableSeats}" />
							</h:column>
							<h:column>
								<f:facet name="header">Prix</f:facet>
								<h:outputText value="#{cpsUserRelated.price}" />
							</h:column>

							<h:column>
								<f:facet name="header">Details</f:facet>
								<h:panelGrid>
									<h:commandButton value="Detail"
										action="#{carPoolingServiceManagementBean.detail(cpsUserRelated.id)}">

										<f:param name="carPoolingServiceId"
											value="#{cpsUserRelated.id}"></f:param>

									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Modifier</f:facet>
								<h:panelGrid>
									<h:commandButton value="Edit"
										action="#{carPoolingServiceManagementBean.updateStepOne()}">

										<f:param name="carPoolingServiceId"
											value="#{cps.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Supprimer</f:facet>
								<h:panelGrid>
									<h:commandButton
										action="#{carPoolingManagementBean.delete(cpsUserRelated.id)}"
										value="Delete" />
								</h:panelGrid>
							</h:column>

						</h:dataTable>
						<br />

						<p
							style="float: left; font-variant: small-caps; font-weight: bold; font-size: larger">Mon
							historique de prestations de location de véhicule</p>

						<h:dataTable class="table container-fluid bg-grey"
							id="carRentalService"
							value="#{userProfileBean.crsListUserRelated}"
							var="crsUserRelated">

							<h:column>
								<f:facet name="header"> Numéro de référence </f:facet>
								<h:outputText value="#{crsUserRelated.referenceNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header">Lieu de récupération des clés </f:facet>
								<h:outputText value="#{crsUserRelated.keyPickUpAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header">Lieu de remise des clés  </f:facet>
								<h:outputText value="#{crsUserRelated.keyDropOffAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header">Date de début</f:facet>
								<h:outputText value="#{crsUserRelated.startDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header">Date de fin</f:facet>
								<h:outputText value="#{crsUserRelated.endDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header">Marque du véhicule</f:facet>
								<h:outputText value="#{crsUserRelated.vehicule.brand}" />
							</h:column>
							<h:column>
								<f:facet name="header">Prix</f:facet>
								<h:outputText value="#{crsUserRelated.price}" />
							</h:column>

							<h:column>
								<f:facet name="header">Détails</f:facet>
								<h:panelGrid>
									<h:commandButton value="Detail"
										action="#{carRentalServiceManagementBean.detail(crsUserRelated.id)}">
										<f:param name="carRentalServiceId"
											value="#{crsUserRelated.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Modifier</f:facet>
								<h:panelGrid>
									<h:commandButton value="Edit"
										action="#{carRentalServiceManagementBean.updateStepOne()}">
										<f:param name="carRentalServiceId"
											value="#{crsUserRelated.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Supprimer</f:facet>
								<h:panelGrid>
									<h:commandButton
										action="#{carRentalServiceManagementBean.delete(crsUserRelated.id)}"
										value="Delete" />
								</h:panelGrid>
							</h:column>
						</h:dataTable>
						<br />

						<p
							style="float: left; font-variant: small-caps; font-weight: bold; font-size: larger">Mon
							historique de prestation de transport de colis</p>

						<h:dataTable class="table container-fluid bg-grey"
							value="#{userProfileBean.psListUserRelated}" var="psUserRelated">


							<h:column>
								<f:facet name="header"> Numéro de référence </f:facet>
								<h:outputText value="#{psUserRelated.referenceNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header">Adresse de départ  </f:facet>
								<h:outputText value="#{psUserRelated.trajectory.pickUpAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header">Date et heure de départ</f:facet>
								<h:outputText value="#{parcelService.startDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header">Adresse d'arrivée </f:facet>
								<h:outputText
									value="#{psUserRelated.trajectory.deliveryAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header">Date et heure d'arrivée</f:facet>
								<h:outputText value="#{psUserRelated.endDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header">Code Barre</f:facet>
								<h:outputText value="#{psUserRelated.barCode}" />
							</h:column>

							<h:column>
								<f:facet name="header">Fragile</f:facet>
								<h:outputText value="#{psUserRelated.fragile? 'Oui' : 'Non'}" />
							</h:column>

							<h:column>
								<f:facet name="header">Volumineux</f:facet>
								<h:outputText value="#{psUserRelated.atypicalVolume? 'Oui' : 'Non'}" />
							</h:column>

							<h:column>
								<f:facet name="header">Poids</f:facet>
								<h:outputText value="#{psUserRelated.weightKilogrammes}" />
							</h:column>


							<h:column>
								<f:facet name="header">Prix</f:facet>
								<h:outputText value="#{psUserRelated.price}" />
							</h:column>
							<h:column>
								<f:facet name="header">Détails</f:facet>
								<h:panelGrid>
									<h:commandButton value="Detail"
										action="#{parcelServiceManagementBean.detail(psUserRelated.id)}">
										<f:param name="parcelServiceId" value="#{psUserRelated.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Modifier</f:facet>
								<h:panelGrid>
									<h:commandButton value="Edit"
										action="#{parcelServiceManagementBean.updateStepOne()}">
										<f:param name="parcelServiceId" value="#{psUserRelated.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Supprimer</f:facet>
								<h:panelGrid>
									<h:commandButton
										action="#{parcelServiceManagementBean.delete(psUserRelated.id)}"
										value="Delete" />
								</h:panelGrid>
							</h:column>

						</h:dataTable>
						<br />
						<p
							style="float: left; font-variant: small-caps; font-weight: bold; font-size: larger">Mon
							historique de prestation d'aide à la personne</p>
						
						<h:dataTable class="table container-fluid bg-grey"
							value="#{userProfileBean.pasListUserRelated}"
							var="pasUserRelated">

							<h:column>
								<f:facet name="header"> Numéro de référence </f:facet>
								<h:outputText value="#{pasUserRelated.referenceNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header">Adresse de départ  </f:facet>
								<h:outputText value="#{pasUserRelated.trajectory.pickUpAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header">Date et heure de départ</f:facet>
								<h:outputText value="#{pasUserRelated.startDate.format(userProfileBean.formatter)}" />
							</h:column>
							<h:column>
								<f:facet name="header">Adresse d'arrivée </f:facet>
								<h:outputText
									value="#{pasUserRelated.trajectory.deliveryAddress}" />
							</h:column>
							<h:column>
								<f:facet name="header">Date et heure d'arrivée</f:facet>
								<h:outputText value="#{pasUserRelated.endDate.format(userProfileBean.formatter)}" />
							</h:column>

							<h:column>
								<f:facet name="header">Prix</f:facet>
								<h:outputText value="#{pasUserRelated.price}" />
							</h:column>
							<h:column>
								<f:facet name="header">Détails</f:facet>
								<h:panelGrid>
									<h:commandButton value="Detail"
										action="#{personalAssistanceServiceManagementBean.detail(pasUserRelated.id)}">
										<f:param name="personalAssistanceServiceId"
											value="#{pasUserRelated.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>
								<f:facet name="header">Modifier</f:facet>
								<h:panelGrid>
									<h:commandButton value="Edit"
										action="#{personalAssistanceServiceManagementBean.updateStepOne()}">
										<f:param name="personalAssistanceServiceId"
											value="#{pasUserRelated.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							<h:column>

								<f:facet name="header">Supprimer</f:facet>
								<h:panelGrid>
									<h:commandButton 
										action="#{personalAssistanceServiceManagementBean.delete(pasUserRelated.id)}"
										value="Delete" />
								</h:panelGrid>
							</h:column>
						</h:dataTable>
						
						<p
							style="float: left; font-variant: small-caps; font-weight: bold; font-size: larger">Mon
							historique de factures</p>

						
						<h:dataTable class="table container-fluid bg-grey"
							value="#{userProfileBean.userServiceInvoiceWhenPurchaser}"
							var="userServiceInvoiceWhenPurchaser">

							<h:column>
								<f:facet name="header"> Numéro de référence </f:facet>
								<h:outputText value="#{userServiceInvoiceWhenPurchaser.invoiceNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header"> Type de facture</f:facet>
								<h:outputText value="#{userProfileBean.labelServiceInvoice}" />
							</h:column>
							<h:column>
								<f:facet name="header">Prestataire du service</f:facet>
								<h:outputText value="#{userServiceInvoiceWhenPurchaser.userAccountProvider.username}" />
								
							</h:column>
							<h:column>
								<f:facet name="header">Date</f:facet>
								<h:outputText value="#{userServiceInvoiceWhenPurchaser.invoiceIssueDate}" />
							</h:column>
							<h:column>
								<f:facet name="header">Voir la facture</f:facet>
								<h:panelGrid>
									<h:commandButton value="Detail"
										action="#{userProfileBean.GoToServiceInvoice(userServiceInvoiceWhenPurchaser.id)}">
										<f:param name="serviceInvoiceId" value="#{userServiceInvoiceWhenPurchaser.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							
							
						</h:dataTable>
						<h:dataTable class="table container-fluid bg-grey"
							value="#{userProfileBean.userStoreInvoice}"
							var="userStoreInvoice">

							<h:column>
								<f:facet name="header"> Numéro de référence </f:facet>
								<h:outputText value="#{userStoreInvoice.invoiceNumber}" />
							</h:column>
							<h:column>
								<f:facet name="header"> Type de facture</f:facet>
								<h:outputText value="#{userProfileBean.labelStoreInvoice}" />
							</h:column>
							<h:column>
								<f:facet name="header">Montant de l'achat</f:facet>
								<h:outputText value="#{userStoreInvoice.amount}" />
								
							</h:column>
							<h:column>
								<f:facet name="header">Date</f:facet>
								<h:outputText value="#{userStoreInvoice.invoiceIssueDate}" />
							</h:column>
							<h:column>
								<f:facet name="header">Voir la facture</f:facet>
								<h:panelGrid>
									<h:commandButton value="Detail"
										action="#{userProfileBean.GoToStoreInvoice(userStoreInvoice.id)}">
										<f:param name="storeInvoiceId" value="#{userStoreInvoice.id}"></f:param>
									</h:commandButton>
								</h:panelGrid>
							</h:column>
							
							
						</h:dataTable>
					</div>
				</div>
				<br />
			</h:form>
		</ui:define>
	</ui:composition>


</h:body>
</html>